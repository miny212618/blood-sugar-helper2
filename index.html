
<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>血糖助手紀錄版</title>
<style>
    body { font-family: Arial, sans-serif; padding: 20px; background: #eaffea; }
    input, button, select { margin: 5px 0; padding: 5px; width: 100%; max-width: 300px; }
    .section { margin-bottom: 30px; }
    .record-box { background: #eef; padding: 10px; margin-top: 10px; white-space: pre-wrap; }
    .record-entry { margin-bottom: 10px; }
    .record-buttons { margin-top: 5px; }
</style>
</head>
<body>
<h2 style="text-align: center;">血糖助手</h2>
<div class="section">
  餐前血糖（mg/dL）<br/>
  <input id="preMealBloodSugar" oninput="autoCalculate()" type="number"/><br/>

  目標血糖（mg/dL）<br/>
  <input id="targetBloodSugar" oninput="autoCalculate()" type="number" value="100"/><br/>

  早餐 CI 值：<br/>
  <input id="breakfastCI" type="number" value="8"/><br/>

  午餐 CI 值：<br/>
  <input id="lunchCI" type="number" value="10"/><br/>

  晚餐 CI 值：<br/>
  <input id="dinnerCI" type="number" value="10"/><br/>

  血糖修正因子（每 1U 可降幾 mg/dL）<br/>
  <input id="correctionFactor" oninput="autoCalculate()" type="number" value="100"/><br/>

  碳水化合物（g）<br/>
  <input id="carbohydrates" oninput="autoCalculate()" type="number"/><br/>

  碳水比（CI 值）<br/>
  <input id="carbIndex" oninput="autoCalculate()" type="number"/><br/>
  <div style="color: red;">星期二早餐建議係數：8</div><br/>

  實際打的胰島素劑量<br/>
  <input id="actualDose" type="number"/><br/>

  備註（吃什麼）<br/>
  <input id="note" type="text"/><br/>

  <button onclick="saveData()">儲存資料</button>
</div>
<div class="section">
  <h3>今日紀錄</h3>
  <div id="recordDisplay"></div>
</div>

<script>
function autoCalculate() {
  // 略：省略實際計算邏輯
}

function saveData() {
  let note = document.getElementById("note").value;
  const now = new Date();
  const time = now.toTimeString().split(' ')[0].slice(0, 5);
  const preMealBS = document.getElementById("preMealBloodSugar").value;
  const carbs = document.getElementById("carbohydrates").value;
  const ci = document.getElementById("carbIndex").value;
  const dose = document.getElementById("actualDose").value;

  const record = `時間：${time} 餐前血糖：${preMealBS}，碳水：${carbs}g，CI：${ci}，施打：${dose}U，備註：${note}`;

  let records = JSON.parse(localStorage.getItem("records") || "[]");
  records.push(record);
  localStorage.setItem("records", JSON.stringify(records));
  displayRecords();
}

function displayRecords() {
  let records = JSON.parse(localStorage.getItem("records") || "[]");
  const container = document.getElementById("recordDisplay");
  container.innerHTML = "";
  records.forEach((r, i) => {
    const div = document.createElement("div");
    div.className = "record-box";
    div.textContent = `#${i + 1} ${r}`;
    container.appendChild(div);
  });
}
window.onload = displayRecords;
</script>
</body>
</html>
